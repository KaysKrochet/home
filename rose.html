<!-- Add a hidden input for the order date -->
<input type="hidden" name="orderDate" id="hiddenOrderDate">

<script>
    let currentImage = 0;
    const images = ["Rose.png", "Rose2.png", "Rose3.png"];
    const roseImage = document.getElementById('roseImage');
    const checkboxes = document.querySelectorAll('input[name="color"]');
    const error = document.getElementById('error');
    const slider = document.getElementById('roseQuantity');
    const sliderValue = document.getElementById('sliderValue');

    function changeImage() {
        currentImage = (currentImage + 1) % images.length;
        roseImage.src = images[currentImage];
        roseImage.style.opacity = 0;
        setTimeout(() => {
            roseImage.src = images[currentImage];
            roseImage.style.opacity = 1;
        }, 500);
    }

    function checkSingleCheckbox(clickedCheckbox) {
        checkboxes.forEach(checkbox => {
            if (checkbox !== clickedCheckbox) checkbox.checked = false;
        });
        if (Array.from(checkboxes).filter(checkbox => checkbox.checked).length > 1) {
            error.style.display = 'block';
            setTimeout(() => error.style.display = 'none', 2000);
        }
        updateOrder();
    }

    function updateOrder() {
        const quantity = slider.value;
        const colors = Array.from(checkboxes).filter(checkbox => checkbox.checked).map(checkbox => checkbox.value);
        const totalCost = quantity * 3 + colors.length * 3;
        sliderValue.innerText = quantity;
        document.getElementById('totalCost').innerText = `Total Cost: $${totalCost}`;
        document.getElementById('orderSummary').innerText = `What You Ordered: ${quantity} Rose(s), Color: ${colors.join(', ')}`;
    }

    function prepareOrder() {
        const quantity = slider.value;
        const colors = Array.from(checkboxes).filter(checkbox => checkbox.checked).map(checkbox => checkbox.value);
        const totalCost = document.getElementById('totalCost').innerText;

        const date = new Date().toLocaleString();

        document.getElementById('hiddenQuantity').value = quantity;
        document.getElementById('hiddenColors').value = colors.join(', ');
        document.getElementById('hiddenTotalCost').value = totalCost;
        document.getElementById('hiddenOrderDate').value = date;
    }

    document.getElementById('orderForm').addEventListener('submit', function(event) {
        event.preventDefault();
        prepareOrder();

        const formData = new FormData(this);

        const orderData = {};
        formData.forEach((value, key) => {
            orderData[key] = value;
        });

        let orders = JSON.parse(localStorage.getItem('orders')) || [];
        orders.push(orderData);
        localStorage.setItem('orders', JSON.stringify(orders));

        alert('Order successfully sent!');
        window.location.href = 'thanks.html';
    });
</script>
